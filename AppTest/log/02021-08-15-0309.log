############### Start executing 'pubAndSub' on environment 'DEV' at 2021-08-15 15:09:41.295 ###############

Producing message...
Timestamp: 2021-08-15 15:09:46.576
Topic: OSCO_ESED_C02_ORDER_DEV
Partition: 0
Offset: 18790
Key: 6edc2e94-3d25-4568-8142-66201aa186ec
Headers: 
Message: {
  "orderNumber": "20065392A",
  "versionNumber": 2,
  "companyId": "1",
  "banner": "Safeway",
  "storeNumber": "2941",
  "orderStatus": "COMPLETED",
  "orderCreatedDate": "2020-12-28T19:04:06.090Z",
  "sourceInfo": {
    "source": "ECHO",
    "enteredBy": "CUSTOMER",
    "deviceType": "WEB"
  },
  "orderTotal": {
    "amount": 130.32,
    "currency": "USD"
  },
  "customer": {
    "customerId": "557-145-1597354036238",
    "clubCardNumber": "49291215654",
    "isSubscription": false,
    "name": {
      "firstName": "adithya",
      "lastName": "patha"
    },
    "address": [
      {
        "addressType": "SHIP-TO",
        "addressLine1": "707 Contra Costa Blvd",
        "city": "Pleasant Hill",
        "state": "CA",
        "zipCode": "94523",
        "country": "USA"
      }
    ],
    "contact": [
      {
        "number": "6513097229",
        "type": "MOBILE"
      }
    ],
    "email": [
      {
        "id": "apath08@safeway.com",
        "type": "PERSONAL"
      }
    ],
    "preference": {
      "optIn": [
        {
          "type": "TEXT",
          "id": "6513097229",
          "isOptin": false
        }
      ]
    }
  },
  "paymentDetails": [],
  "subOrders": [
    {
      "subOrderNumber": 1,
      "subOrderStatus": "COMPLETED",
      "fulfillmentType": "DUG",
      "deliveryInfo": {
        "slotInfo": {
          "slotType": "ONEHR",
          "slotId": "42925a6b-98fb-4e61-ac7e-a5ba9c85fdb3",
          "timeZone": "America/Los_Angeles",
          "startTime": "2020-12-28T23:00:00.000Z",
          "endTime": "2020-12-29T00:00:00.000Z",
          "shiftNumber": "2",
          "editingCutoffDate": "2020-12-28T20:00:00.000Z",
          "lastPickupTime": "2020-12-29T04:00:00.000Z",
          "slotPlan": "STANDARD"
        },
        "instructions": "",
        "pickupInfo": {
          "locationType": "STORE",
          "locationId": "2941",
          "shortOrderNumber": 493
        },
        "stageByDateTime": "2020-12-28T21:00:00.000Z"
      },
      "charges": [],
      "promoCodes": [],
      "tote": {
        "toteDetails": []
      },
      "orderLines": [
        {
          "itemId": "85016200821",
          "itemDescription": "10 Barrel Out Of Office Hoppy Pilsner In Cans - 6-12 Fl. Oz.",
          "orderedQuantity": 2,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": true,
          "suppliedQuantity": 2,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 12.99,
            "currency": "USD"
          },
          "itemTotalTax": 0.6,
          "discountsApplied": 0
        },
        {
          "itemId": "03800033360",
          "itemDescription": "Eggo Frozen Waffles Blueberry Family Pack - 29.6 Oz",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 1,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 8.49,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "05210000428",
          "itemDescription": "McCormick Chili Powder - 2.5 Oz",
          "orderedQuantity": 2,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 2,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 4.79,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "03800033360",
          "itemDescription": "Eggo Frozen Waffles Blueberry Family Pack - 29.6 Oz",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 1,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 8.49,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "00000004070",
          "itemDescription": "Celery - 1 Bunch",
          "orderedQuantity": 5,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 5,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 0.99,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "00000004070",
          "itemDescription": "Cilantro Organic",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 1,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 0.99,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "03452",
          "itemDescription": "Green Seedless Grapes - 2 Lb",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 2.8,
          "suppliedQuantityType": "WEIGHTED",
          "suppliedUnitPrice": {
            "amount": 4.99,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "03452",
          "itemDescription": "Green Seedless Grapes - 2 Lb",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 2.8,
          "suppliedQuantityType": "WEIGHTED",
          "suppliedUnitPrice": {
            "amount": 4.99,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "26052690964",
          "itemDescription": "Foster Farms Organic Chicken Breast Fillets Boneless Skinless - 1.00 LB",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 1,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 9.64,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "26080590158",
          "itemDescription": "Foster Farms Fresh & Natural Whole Chicken - 3.5 Lbs.",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": false,
          "suppliedQuantity": 1,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 1.58,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        },
        {
          "itemId": "08158445262",
          "itemDescription": "Kendall-Jackson Vintners Reserve Wine White Chardonnay - 750 Ml",
          "orderedQuantity": 1,
          "unitOfMeasure": "UNIT",
          "substitutionValue": "Same Brand Diff Size",
          "isRegulatedItem": true,
          "suppliedQuantity": 1,
          "suppliedQuantityType": "UNIT",
          "suppliedUnitPrice": {
            "amount": 17.99,
            "currency": "USD"
          },
          "itemTotalTax": 0,
          "discountsApplied": 0
        }
      ],
      "refundedOrderLines": [
        {
          "itemDescription": "10 BARREL PROFUSE ",
          "unitPrice": {
            "amount": 25.98,
            "currency": "USD"
          },
          "refundedQuantity": 1,
          "referenceOrderId": "20065392",
          "itemId": "85016200821"
        },
        {
          "itemDescription": "KLLGG EGGO WAFFLES",
          "unitPrice": {
            "amount": 0,
            "currency": "USD"
          },
          "refundedQuantity": 1,
          "referenceOrderId": "20065392",
          "itemId": "03800033360"
        },
        {
          "itemDescription": "MCRMCK CHILI PWDR ",
          "unitPrice": {
            "amount": 9.58,
            "currency": "USD"
          },
          "refundedQuantity": 1,
          "referenceOrderId": "20065392",
          "itemId": "05210000428"
        }
      ],
      "messageAction": "COMPLETED",
      "customerService": {
        "contact": [
          {
            "number": "7298374987",
            "type": "PHONE",
            "subType": "DUG_VIRTUAL_PHONE"
          },
          {
            "number": "7932874987",
            "type": "PHONE",
            "subType": "CUST_SERV_PHONE"
          }
        ]
      }
    }
  ],
  "tender": [
    {
      "refundId": 8630,
      "tenderType": "CANCELLATION",
      "tenderSubType": "credit_on_account",
      "chargeAmount": {
        "amount": 28.9,
        "currency": "USD"
      }
    }
  ],
  "storeInfo": null,
  "modifiedDate": "2020-12-28T19:25:02.753",
  "orderInfo": {
    "stageByDateTime": "2020-12-28T21:00:00.000Z"
  },
  "ttl": -1
}
Message produced.

......

Consuming message...
Timestamp: 2021-08-15 15:09:49.045
Topic: ESED_C01_GroceryOrder_JSON
Partition: 2
Offset: 33
Headers: 
Key: null
Message: 
{
  "GetGroceryOrder": {
    "Abs": "https://collab.safeway.com/it/architecture/info/default.aspx",
    "DocumentData": {
      "Document": {
        "SystemEnvironmentCd": "DV",
        "VersionId": "v1.13.1.221",
        "DocumentID": "GROCERY_ORDER",
        "AlternateDocumentID": "OSCO_ESED_C02_ORDER_DEV_0_18790_20210815160948898526",
        "DocumentNm": "GroceryOrder",
        "CreationDt": "2021-08-15 16:09:48.898526",
        "Description": [
          "GroceryOrderDetail"
        ],
        "SourceApplicationCd": [
          "OMS"
        ],
        "TargetApplicationCd": "EDIS",
        "InternalFileTransferInd": "Y",
        "DataClassification": {
          "DataClassificationLevel": {
            "Code": "Internal"
          },
          "BusinessSensitivityLevel": {
            "Code": "Low"
          },
          "PHIdataInd": "N",
          "PCIdataInd": "Y",
          "PIIdataInd": "Y"
        }
      },
      "DocumentAction": {
        "ActionTypeCd": "UPDATE",
        "RecordTypeCd": "CHANGE"
      }
    },
    "GroceryOrderData": {
      "GroceryOrderHeader": {
        "OrderId": "20065392A",
        "OrderCreateTS": "2020-12-28T19:04:06.090Z",
        "OrderModifyTS": "2020-12-28T19:25:02.753",
        "CompanyId": "1",
        "VersionNbr": "2",
        "OrderStatus": {
          "StatusTypeCd": "COMPLETED"
        },
        "FulfillingFacility": {
          "RetailStoreId": "2941",
          "BannerCd": "Safeway"
        },
        "GroceryOrderProfileType": {
          "ProfileType": {
            "Code": "AutoReplenishment"
          },
          "ProfileValueInd": "N"
        },
        "RetailCustomer": {
          "CustomerId": "557-145-1597354036238",
          "CustomerAlternateId": [
            {}
          ],
          "CustomerNm": {
            "GivenNm": "2EmCYfz",
            "FamilyNm": "CJMQL"
          },
          "Contact": [
            {
              "PhoneFaxContact": {
                "TypeCode": "MOBILE",
                "PhoneNbrTxt": "9qouQuHpFf"
              }
            },
            {
              "DigitalContact": {
                "DigitalAddress": "dIhIUEb@8lR3a8X.tWQ"
              }
            },
            {
              "Address": {
                "AddressUsageTypeCd": "epgj-qg",
                "AddressLine1txt": "gRq 3X6yoi kkayj Efsq",
                "CityNm": "UDlVmQyk lFetK",
                "PostalZoneCd": "wqfh4",
                "StateCd": "Hpz",
                "CountryCd": "USA"
              }
            }
          ],
          "ClubCardNbr": "49291215654",
          "CustomerSubscription": [
            {
              "OptInInd": "false"
            }
          ]
        },
        "CurrencyCd": "USD",
        "TotalAmt": 130.32,
        "CustomerPayment": {
          "Tender": [
            {
              "Cancellation": [
                {
                  "RefundId": "8630",
                  "TenderTypeCd": "credit_on_account",
                  "TotalAmt": 28.9,
                  "CurrencyCd": "USD"
                }
              ]
            }
          ]
        },
        "OrderRecordDateInfo": {
          "CreateUserId": "CUSTOMER",
          "UpdateDtTm": "2020-12-28T19:25:02.753"
        },
        "Device": {
          "Code": "WEB"
        },
        "OrderCreatedDeviceType": {
          "Code": "WEB"
        },
        "OrderSourceSystemType": {
          "Code": "ECHO"
        }
      },
      "GrocerySubOrder": [
        {
          "SubOrderNbr": "1",
          "SubOrderStatus": {
            "StatusTypeCd": "COMPLETED"
          },
          "SubOrderActionStatus": {
            "StatusTypeCd": "COMPLETED"
          },
          "GroceryOrderDetail": [
            {
              "ItemId": {
                "SystemSpecificItemId": "85016200821",
                "BaseProductNbr": 8.5016200821E10,
                "ItemDescription": "10 Barrel Out Of Office Hoppy Pilsner In Cans - 6-12 Fl. Oz."
              },
              "Quantity": 2.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "TRUE",
              "OrderQty": 2.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "03800033360",
                "BaseProductNbr": 3.80003336E9,
                "ItemDescription": "Eggo Frozen Waffles Blueberry Family Pack - 29.6 Oz"
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 1.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "05210000428",
                "BaseProductNbr": 5.210000428E9,
                "ItemDescription": "McCormick Chili Powder - 2.5 Oz"
              },
              "Quantity": 2.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 2.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "03800033360",
                "BaseProductNbr": 3.80003336E9,
                "ItemDescription": "Eggo Frozen Waffles Blueberry Family Pack - 29.6 Oz"
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 1.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "00000004070",
                "BaseProductNbr": 4070.0,
                "ItemDescription": "Celery - 1 Bunch"
              },
              "Quantity": 5.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 5.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "00000004070",
                "BaseProductNbr": 4070.0,
                "ItemDescription": "Cilantro Organic"
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 1.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "03452",
                "BaseProductNbr": 3452.0,
                "ItemDescription": "Green Seedless Grapes - 2 Lb"
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 1.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "03452",
                "BaseProductNbr": 3452.0,
                "ItemDescription": "Green Seedless Grapes - 2 Lb"
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 1.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "26052690964",
                "BaseProductNbr": 2.6052690964E10,
                "ItemDescription": "Foster Farms Organic Chicken Breast Fillets Boneless Skinless - 1.00 LB"
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 1.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "26080590158",
                "BaseProductNbr": 2.6080590158E10,
                "ItemDescription": "Foster Farms Fresh \u0026 Natural Whole Chicken - 3.5 Lbs."
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "FALSE",
              "OrderQty": 1.0
            },
            {
              "ItemId": {
                "SystemSpecificItemId": "08158445262",
                "BaseProductNbr": 8.158445262E9,
                "ItemDescription": "Kendall-Jackson Vintners Reserve Wine White Chardonnay - 750 Ml"
              },
              "Quantity": 1.0,
              "UOM": {
                "UOMCd": "UNIT"
              },
              "SubstitutionType": {
                "Description": "Same Brand Diff Size"
              },
              "RegulatedItemInd": "TRUE",
              "OrderQty": 1.0
            }
          ],
          "ReturnedItem": [
            {
              "ReferenceOrderId": "20065392",
              "Item": {
                "BaseProductNbr": 8.5016200821E10,
                "ItemDescription": "10 BARREL PROFUSE "
              },
              "Quantity": 1.0,
              "UnitPriceAmt": 25.98,
              "CurrencyCd": "USD"
            },
            {
              "ReferenceOrderId": "20065392",
              "Item": {
                "BaseProductNbr": 3.80003336E9,
                "ItemDescription": "KLLGG EGGO WAFFLES"
              },
              "Quantity": 1.0,
              "UnitPriceAmt": 0.0,
              "CurrencyCd": "USD"
            },
            {
              "ReferenceOrderId": "20065392",
              "Item": {
                "BaseProductNbr": 5.210000428E9,
                "ItemDescription": "MCRMCK CHILI PWDR "
              },
              "Quantity": 1.0,
              "UnitPriceAmt": 9.58,
              "CurrencyCd": "USD"
            }
          ],
          "FullFillmentType": {
            "Code": "DUG"
          },
          "PickupInfo": {
            "ShortOrderNbr": 493.0,
            "PickupSlot": {
              "Code": "2941"
            },
            "PickupSlotType": {
              "Code": "STORE"
            },
            "DisplayEndDttm": "2020-12-29T04:00:00.000Z"
          },
          "DeliveryInfo": {
            "DeliverySlotId": "42925a6b-98fb-4e61-ac7e-a5ba9c85fdb3",
            "DeliverySlotType": {
              "Code": "ONEHR"
            },
            "SlotPlan": {
              "Code": "STANDARD"
            },
            "StartDttm": "2020-12-28T23:00:00.000Z",
            "EndDttm": "2020-12-29T00:00:00.000Z",
            "SlotExpiryDttm": "2020-12-29T00:00:00.000Z",
            "StageByDttm": "2020-12-28T21:00:00.000Z",
            "EditCutoffDtTm": "2020-12-28T20:00:00.000Z",
            "CustomerInstructionTxt": "",
            "DeliveryTimeZoneCd": "America/Los_Angeles"
          },
          "CustomerService": [
            {
              "PhoneFaxContact": {
                "TypeCode": "PHONE",
                "PhoneNbrTxt": "7298374987",
                "PhonePurposes": {
                  "PurposeDsc": "DUG_VIRTUAL_PHONE"
                }
              }
            },
            {
              "PhoneFaxContact": {
                "TypeCode": "PHONE",
                "PhoneNbrTxt": "7932874987",
                "PhonePurposes": {
                  "PurposeDsc": "CUST_SERV_PHONE"
                }
              }
            }
          ],
          "InstructionTxt": [
            "",
            "",
            "",
            "",
            "",
            "",
            "",
            "",
            "",
            "",
            ""
          ]
        }
      ]
    }
  }
}
Message consumed.

-------------- Execution succeeded, using 11690ms ---------------

